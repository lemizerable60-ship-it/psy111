import T,{useState as k,useEffect as U,useRef as H}from"https://esm.sh/react@18.2.0";import F from"https://esm.sh/react-dom@18.2.0/client";import{GoogleGenAI as M}from"https://esm.sh/@google/genai";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();const t=T.createElement,q=()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197"})),W=()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})),V=()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})),Y=()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})),_=()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},t("path",{d:"M8 2a2 2 0 00-2 2v12a2 2 0 002 2h4a2 2 0 002-2V4a2 2 0 00-2-2H8z"}),t("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})),y=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleDateString("ru-RU")}catch{return o}},K=(o,e)=>{const s=document.createElement("a"),a=new Blob([e],{type:"text/plain;charset=utf-8"});s.href=URL.createObjectURL(a),s.download=o,document.body.appendChild(s),s.click(),document.body.removeChild(s)};function C(o,e){const[s,a]=k(()=>{const i=window.localStorage.getItem(e);return i!==null?JSON.parse(i):o});return U(()=>{window.localStorage.setItem(e,JSON.stringify(s))},[e,s]),[s,a]}let Z=class{constructor(){const e=window.GEMINI_API_KEY;if(e&&e!=="ВАШ_КЛЮЧ_API_СЮДА")try{this.ai=new M({apiKey:e})}catch(s){console.error("Error initializing Gemini AI Service:",s),this.ai=null}else console.warn("Gemini API Key is not configured in config.js. AI features will be unavailable."),this.ai=null}isAvailable(){return this.ai!==null}async getTestInterpretation(e,s,a){if(!this.ai)throw new Error("AI Service is not available.");const i=`
            Ты — профессиональный клинический психолог.
            Проанализируй следующие результаты психологического теста.
            Предоставь подробную, структурированную и эмпатичную интерпретацию на основе баллов.
            Не повторяй стандартную интерпретацию дословно; расширь и дополни её.
            Объясни, что эти баллы могут означать с точки зрения эмоционального состояния, когнитивных функций и потенциальных проблемных областей.
            Предложи возможные следующие шаги или темы для обсуждения с терапевтом.
            Твой ответ должен быть на русском языке.

            Название теста: ${e}
            Баллы: ${JSON.stringify(s)}
            Стандартная интерпретация: ${a}

            Начинай свою подробную интерпретацию.
        `;return(await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i})).text}async getConsolidatedInterpretation(e,s){if(!this.ai)throw new Error("AI Service is not available.");const a=s.map(c=>`
                Тест: ${I[c.testKey].name} (проведен ${y(c.date)})
                Баллы: ${JSON.stringify(c.scores)}
                Стандартная интерпретация: ${Object.values(c.interpretation).join(" ")}
            `).join(`
---
`),i=`
            Ты — эксперт в области клинической психологии, анализирующий несколько результатов тестов одного клиента.
            Имя клиента: ${e.name}
            Дата рождения клиента: ${y(e.birthDate)}

            Вот результаты нескольких диагностических тестов:
            ${a}

            Основываясь на этих сводных данных, предоставь целостный анализ. Твой анализ должен:
            1. Определить совпадения и расхождения в результатах разных тестов.
            2. Сформулировать всеобъемлющий психологический профиль клиента.
            3. Выделить потенциальные первичные и вторичные проблемы.
            4. Предложить предварительную диагностическую гипотезу, если это применимо.
            5. Дать рекомендации по терапевтическому вмешательству, включая возможные подходы (например, КПТ, психодинамический) и области для фокусировки.
            6. Сохранять профессиональный, эмпатичный и клинический тон.
            Твой ответ должен быть полностью на русском языке.

            Начинай свой сводный анализ.
        `;return(await this.ai.models.generateContent({model:"gemini-2.5-pro",contents:i})).text}};const S=new Z,I={mmse:{name:"Mini-Mental State Examination (MMSE)",questions:[{text:"Какой сейчас год?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какое сейчас время года?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какой сейчас месяц?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какое сегодня число?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какой сегодня день недели?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Где мы находимся? (Страна)",options:["Правильно","Неправильно"],points:[1,0]},{text:"Где мы находимся? (Область/Регион)",options:["Правильно","Неправильно"],points:[1,0]},{text:"Где мы находимся? (Город)",options:["Правильно","Неправильно"],points:[1,0]},{text:"Как называется это место (клиника/больница)?",options:["Правильно","Неправильно"],points:[1,0]},{text:"На каком этаже мы находимся?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Назовите 3 слова: Яблоко, Стол, Монета. (повторил 1-е)",options:["Да","Нет"],points:[1,0]},{text:"Назовите 3 слова: Яблоко, Стол, Монета. (повторил 2-е)",options:["Да","Нет"],points:[1,0]},{text:"Назовите 3 слова: Яблоко, Стол, Монета. (повторил 3-е)",options:["Да","Нет"],points:[1,0]},{text:"Отнимите от 100 семь (93).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (86).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (79).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (72).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (65).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Вспомните 3 слова, которые я просил вас запомнить. (Яблоко)",options:["Да","Нет"],points:[1,0]},{text:"Вспомните 3 слова, которые я просил вас запомнить. (Стол)",options:["Да","Нет"],points:[1,0]},{text:"Вспомните 3 слова, которые я просил вас запомнить. (Монета)",options:["Да","Нет"],points:[1,0]},{text:"Покажите карандаш и часы, попросите назвать их. (Назвал карандаш)",options:["Да","Нет"],points:[1,0]},{text:"Покажите карандаш и часы, попросите назвать их. (Назвал часы)",options:["Да","Нет"],points:[1,0]},{text:"Попросите повторить фразу: 'Никаких если, и или но'.",options:["Правильно","Неправильно"],points:[1,0]},{text:"Выполните команду из 3-х частей: 'Возьмите лист бумаги правой рукой, сложите его пополам и положите на пол'. (Взял правой рукой)",options:["Да","Нет"],points:[1,0]},{text:"Выполните команду из 3-х частей. (Сложил пополам)",options:["Да","Нет"],points:[1,0]},{text:"Выполните команду из 3-х частей. (Положил на пол)",options:["Да","Нет"],points:[1,0]},{text:"Напишите 'Закройте глаза'. Попросите выполнить. (Выполнил)",options:["Да","Нет"],points:[1,0]},{text:"Попросите написать предложение. (Написал осмысленное предложение)",options:["Да","Нет"],points:[1,0]},{text:"Попросите скопировать рисунок (два пересекающихся пятиугольника). (Скопировал)",options:["Да","Нет"],points:[1,0]}],calculate:o=>({total:o.reduce((s,a)=>s+a,0)}),interpret:o=>{const e=o.total;let s="Нет когнитивных нарушений.";return e>=28&&e<=30?s="Нет когнитивных нарушений.":e>=24&&e<=27?s="Преддементные когнитивные нарушения.":e>=20&&e<=23?s="Деменция легкой степени выраженности.":e>=11&&e<=19?s="Деменция умеренной степени выраженности.":e>=0&&e<=10&&(s="Тяжелая деменция."),{cognitive_status:s}}},hads:{name:"Hospital Anxiety and Depression Scale (HADS)",questions:[{text:"Я испытываю напряжение, мне не по себе",options:["Все время","Часто","Время от времени","Совсем не испытываю"],points:[3,2,1,0]},{text:"То, что приносило мне большое удовольствие, и сейчас вызывает у меня такое же чувство",options:["Определенно, это так","Наверное, это так","Лишь в очень малой степени, это так","Практически нет"],points:[0,1,2,3]},{text:"Я испытываю страх, кажется, что что-то ужасное может вот-вот случиться",options:["Определенно это так, и страх очень велик","Да, это так, но страх не очень велик","Иногда, но это меня не беспокоит","Совсем не испытываю"],points:[3,2,1,0]},{text:"Я способен рассмеяться и увидеть в том или ином событии смешное",options:["Определенно, это так","Наверное, это так","Лишь в очень малой степени, это так","Совсем не способен"],points:[0,1,2,3]},{text:"Беспокойные мысли крутятся у меня в голове",options:["Постоянно","Большую часть времени","Время от времени","Только иногда"],points:[3,2,1,0]},{text:"Я испытываю бодрость",options:["Совсем не испытываю","Очень редко","Иногда","Практически все время"],points:[3,2,1,0]},{text:"Я легко могу присесть и расслабиться",options:["Определенно, это так","Наверное, это так","Лишь изредка, это так","Совсем не могу"],points:[0,1,2,3]},{text:"Я стал медлительным",options:["Практически все время","Часто","Иногда","Совсем нет"],points:[3,2,1,0]},{text:"Я испытываю внутреннее напряжение или дрожь",options:["Совсем не испытываю","Иногда","Часто","Очень часто"],points:[0,1,2,3]},{text:"Я стал следить за своей внешностью",options:["Я слежу за собой как следует","Может быть, я не так много трачу на это времени","Возможно, я стал меньше на это обращать внимания","Определенно, я перестал за собой следить"],points:[0,1,2,3]},{text:"Я не могу усидеть на месте, словно мне постоянно нужно двигаться",options:["Определенно, это так","Наверное, это так","Лишь в некоторой степени, это так","Вовсе нет"],points:[3,2,1,0]},{text:"Я считаю, что мои дела (занятия, увлечения) могут принести мне чувство удовлетворения",options:["Точно так же, как и обычно","Пожалуй, меньше, чем обычно","Значительно меньше, чем обычно","Совсем так не считаю"],points:[0,1,2,3]},{text:"У меня бывает внезапное чувство паники",options:["Очень часто","Довольно часто","Не так уж часто","Совсем не бывает"],points:[3,2,1,0]},{text:"Я могу получить удовольствие от хорошей книги, радио- или телепрограммы",options:["Часто","Иногда","Редко","Очень редко"],points:[0,1,2,3]}],calculate:o=>{const e=o[0]+o[2]+o[4]+o[6]+o[8]+o[10]+o[12],s=o[1]+o[3]+o[5]+o[7]+o[9]+o[11]+o[13];return{anxiety:e,depression:s}},interpret:o=>{const{anxiety:e,depression:s}=o;let a="Норма.";e>=0&&e<=7?a="Норма (отсутствие достоверно выраженных симптомов тревоги).":e>=8&&e<=10?a="Субклинически выраженная тревога.":e>=11&&(a="Клинически выраженная тревога.");let i="Норма.";return s>=0&&s<=7?i="Норма (отсутствие достоверно выраженных симптомов депрессии).":s>=8&&s<=10?i="Субклинически выраженная депрессия.":s>=11&&(i="Клинически выраженная депрессия."),{anxiety:`Anxiety: ${a}`,depression:`Depression: ${i}`}}},zung:{name:"Шкала самооценки депрессии Цунга (Zung Self-Rating Depression Scale)",questions:[{text:"Я чувствую подавленность",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Утром я чувствую себя лучше всего",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"У меня бывают периоды плача или желание плакать",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"У меня плохой ночной сон",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Аппетит у меня не хуже, чем обычно",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Мне приятно смотреть на привлекательных женщин/мужчин, разговаривать с ними",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я замечаю, что теряю вес",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Меня беспокоят запоры",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Мое сердце бьется быстрее, чем обычно",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Я устаю без всякой причины",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Я мыслю так же ясно, как всегда",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Мне легко делать то, что я умею",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Чувствую беспокойство и не могу усидеть на месте",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"У меня есть надежды на будущее",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я более раздражителен, чем обычно",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Мне легко принимать решения",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я чувствую, что полезен и нужен",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я живу достаточно полной жизнью",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я чувствую, что другим людям станет лучше, если я умру",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Меня до сих пор радует то, что радовало всегда",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]}],calculate:o=>({total:o.reduce((s,a)=>s+a,0)}),interpret:o=>{const e=o.total;let s="Состояние без депрессии.";return e<=49?s="Нормальное состояние, депрессия отсутствует.":e>=50&&e<=59?s="Легкая депрессия ситуативного или невротического генеза.":e>=60&&e<=69?s="Субдепрессивное состояние или маскированная депрессия.":e>=70&&(s="Истинное депрессивное состояние (тяжелая депрессия)."),{depression_level:s}}}},h=({children:o,className:e,onClick:s})=>t("div",{onClick:s,className:`bg-white dark:bg-gray-800 shadow-md rounded-lg p-6 ${e||""}`},o),N=({onClick:o,children:e,className:s,type:a="button",disabled:i})=>t("button",{type:a,onClick:o,disabled:i,className:`bg-primary-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-opacity-50 transition-colors duration-200 ${s||""} ${i?"opacity-50 cursor-not-allowed":""}`},e),$=({title:o,onBack:e})=>t("header",{className:"bg-white dark:bg-gray-800 shadow-sm p-4 flex items-center"},e&&t("button",{onClick:e,className:"mr-4 text-gray-600 dark:text-gray-300 hover:text-primary-600"},t(Y)),t("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-200"},o)),j=({setScreen:o})=>t("div",null,t($,{title:"PsychoSuite"}),t("main",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4"},t(h,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>o({name:"clientList"})},t(q),t("h2",{className:"text-lg font-bold mt-2"},"Клиенты"),t("p",{className:"text-gray-600 dark:text-gray-400"},"Просмотр и управление базой клиентов")),t(h,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>o({name:"settings"})},t(W),t("h2",{className:"text-lg font-bold mt-2"},"Настройки"),t("p",{className:"text-gray-600 dark:text-gray-400"},"Импорт и экспорт данных")))),Q=({clients:o,setScreen:e})=>t("div",null,t($,{title:"Список клиентов",onBack:()=>e({name:"home"})}),t("main",{className:"p-4"},t(N,{onClick:()=>e({name:"clientForm",clientId:null}),className:"mb-4 flex items-center"},t(V,{className:"mr-2"}),"Добавить клиента"),t("div",{className:"space-y-2"},o.length>0?o.map(s=>t(h,{key:s.id,className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700",onClick:()=>e({name:"clientDetail",clientId:s.id})},t("h3",{className:"font-bold text-lg"},s.name),t("p",{className:"text-sm text-gray-500"},`Дата рождения: ${y(s.birthDate)}`))):t("p",null,"Список клиентов пуст.")))),X=({clients:o,setClients:e,setScreen:s,clientId:a})=>{const i=a?o.find(m=>m.id===a):null,[n,c]=k((i==null?void 0:i.name)||""),[d,r]=k((i==null?void 0:i.birthDate)||""),u=m=>{m.preventDefault(),e(i?o.map(g=>g.id===a?{...g,name:n,birthDate:d}:g):[...o,{id:Date.now().toString(),name:n,birthDate:d}]),s({name:"clientList"})};return t("div",null,t($,{title:i?"Редактировать клиента":"Новый клиент",onBack:()=>s({name:"clientList"})}),t("main",{className:"p-4"},t("form",{onSubmit:u,className:"space-y-4"},t("div",null,t("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"ФИО"),t("input",{type:"text",id:"name",value:n,onChange:m=>c(m.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500"})),t("div",null,t("label",{htmlFor:"birthDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Дата рождения"),t("input",{type:"date",id:"birthDate",value:d,onChange:m=>r(m.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500"})),t(N,{type:"submit"},"Сохранить"))))},tt=({setScreen:o,clientId:e,clients:s,testResults:a,reports:i})=>{const n=s.find(r=>r.id===e),c=a.filter(r=>r.clientId===e),d=i.filter(r=>r.clientId===e);return n?t("div",null,t($,{title:n.name,onBack:()=>o({name:"clientList"})}),t("main",{className:"p-4 space-y-6"},t(h,null,t("h2",{className:"text-lg font-bold mb-2"},"Информация о клиенте"),t("p",null,`Дата рождения: ${y(n.birthDate)}`),t(N,{onClick:()=>o({name:"clientForm",clientId:n.id}),className:"mt-4 text-sm"},"Редактировать")),t(h,null,t("h2",{className:"text-lg font-bold mb-2"},"Начать новое обследование"),t("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2"},Object.keys(I).map(r=>t(N,{key:r,onClick:()=>o({name:"test",clientId:n.id,testKey:r}),className:"w-full text-center"},I[r].name)))),t(h,null,t("h2",{className:"text-lg font-bold mb-4"},"История обследований"),t("div",{className:"space-y-2"},c.length>0?c.map(r=>t("div",{key:r.id,className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",onClick:()=>o({name:"testResult",resultId:r.id})},t("p",{className:"font-semibold"},I[r.testKey].name),t("p",{className:"text-sm text-gray-500"},`Дата: ${y(r.date)}`))):t("p",null,"Нет пройденных тестов."))),t(h,null,t("h2",{className:"text-lg font-bold mb-4"},"Сводные отчеты"),t(N,{onClick:()=>o({name:"report",clientId:n.id}),className:"mb-4"},"Создать новый сводный отчет"),t("div",{className:"space-y-2"},d.length>0?d.map(r=>t("div",{key:r.id,className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-md cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600",onClick:()=>o({name:"report",clientId:n.id,reportId:r.id})},t("p",{className:"font-semibold"},`Отчет от ${y(r.date)}`),t("p",{className:"text-sm text-gray-500"},`Тестов в отчете: ${r.testResultIds.length}`))):t("p",null,"Нет сохраненных отчетов."))))):t("div",null,"Клиент не найден.")},et=({setScreen:o,clientId:e,testKey:s,testResults:a,setTestResults:i})=>{const n=I[s],[c,d]=k(Array(n.questions.length).fill(null)),r=(g,l)=>{const x=[...c];x[g]=n.questions[g].points[l],d(x)},u=()=>{const g=n.calculate(c.map(b=>b??0)),l=n.interpret(g),x={id:Date.now().toString(),clientId:e,testKey:s,date:new Date().toISOString(),answers:c,scores:g,interpretation:l};i([...a,x]),o({name:"testResult",resultId:x.id})},m=c.every(g=>g!==null);return t("div",null,t($,{title:n.name,onBack:()=>o({name:"clientDetail",clientId:e})}),t("main",{className:"p-4"},t("div",{className:"space-y-6"},n.questions.map((g,l)=>t(h,{key:l},t("p",{className:"font-semibold mb-3"},`${l+1}. ${g.text}`),t("div",{className:"flex flex-wrap gap-2"},g.options.map((x,b)=>t("button",{key:b,onClick:()=>r(l,b),className:`px-3 py-1.5 text-sm rounded-md border transition-colors ${c[l]===n.questions[l].points[b]?"bg-primary-600 text-white border-primary-600":"bg-transparent border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700"}`},x))))),t(N,{onClick:u,disabled:!m},"Завершить тест и посмотреть результаты"))))},ot=({setScreen:o,resultId:e,clients:s,testResults:a,setTestResults:i})=>{const n=a.find(l=>l.id===e),[c,d]=k(!1);if(!n)return t("div",null,"Результат теста не найден.");const r=s.find(l=>l.id===n.clientId),u=I[n.testKey],m=async()=>{if(!S.isAvailable()){alert("Сервис AI недоступен. Проверьте ключ API в файле config.js.");return}d(!0);try{const l=Object.entries(n.interpretation).map(([v,A])=>`${v}: ${A}`).join(`
`),x=await S.getTestInterpretation(u.name,n.scores,l),b=a.map(v=>v.id===e?{...v,aiInterpretation:x}:v);i(b)}catch(l){console.error(l),alert("Произошла ошибка при получении интерпретации от AI.")}finally{d(!1)}},g=()=>{let l=`ПРОТОКОЛ ОБСЛЕДОВАНИЯ
=========================

`;l+=`Клиент: ${(r==null?void 0:r.name)||"N/A"}
`,l+=`Дата рождения: ${y((r==null?void 0:r.birthDate)||"")}

`,l+=`Тест: ${u.name}
`,l+=`Дата проведения: ${y(n.date)}

`,l+=`ОТВЕТЫ
-------------------------
`,u.questions.forEach((x,b)=>{const v=x.points.indexOf(n.answers[b]),A=v!==-1?x.options[v]:"Нет ответа";l+=`${b+1}. ${x.text}: ${A} (${n.answers[b]} балл(ов))
`}),l+=`
ИТОГОВЫЕ РЕЗУЛЬТАТЫ
-------------------------
`,Object.entries(n.scores).forEach(([x,b])=>{l+=`${x.charAt(0).toUpperCase()+x.slice(1)}: ${b}
`}),l+=`
Стандартная интерпретация:
`,Object.values(n.interpretation).forEach(x=>{l+=`- ${x}
`}),n.aiInterpretation&&(l+=`
AI ИНТЕРПРЕТАЦИЯ
-------------------------
`,l+=n.aiInterpretation),K(`Протокол_${r==null?void 0:r.name}_${u.name}_${y(n.date)}.txt`,l)};return t("div",null,t($,{title:"Результаты теста",onBack:()=>o({name:"clientDetail",clientId:n.clientId})}),t("main",{className:"p-4 space-y-6"},t("div",{className:"flex justify-end"},t(N,{onClick:g,className:"flex items-center"},t(_),"Сохранить протокол (.txt)")),t(h,null,t("h2",{className:"text-lg font-bold mb-4"},"Протокол обследования"),t("div",{className:"grid grid-cols-2 gap-4 mb-6"},t("div",null,t("p",{className:"text-sm text-gray-500"},"Клиент"),t("p",{className:"font-semibold"},r==null?void 0:r.name)),t("div",null,t("p",{className:"text-sm text-gray-500"},"Дата рождения"),t("p",{className:"font-semibold"},y((r==null?void 0:r.birthDate)||""))),t("div",null,t("p",{className:"text-sm text-gray-500"},"Тест"),t("p",{className:"font-semibold"},u.name)),t("div",null,t("p",{className:"text-sm text-gray-500"},"Дата проведения"),t("p",{className:"font-semibold"},y(n.date)))),t("h3",{className:"text-md font-bold mb-2 border-t pt-4"},"Итоговые результаты"),t("div",{className:"flex items-start gap-8"},t("div",{className:"flex gap-4"},Object.entries(n.scores).map(([l,x])=>t("div",{key:l,className:"text-center"},t("p",{className:"text-3xl font-bold text-primary-600"},x),t("p",{className:"text-sm text-gray-500"},l)))),t("div",null,t("h4",{className:"font-semibold mb-1"},"Стандартная интерпретация:"),t("ul",{className:"list-disc list-inside space-y-1"},Object.values(n.interpretation).map((l,x)=>t("li",{key:x},l)))))),t(h,null,t("h3",{className:"text-md font-bold mb-2"},"AI Интерпретация"),n.aiInterpretation?t("div",{className:"whitespace-pre-wrap p-2 bg-gray-50 dark:bg-gray-700 rounded"},n.aiInterpretation):t("div",null,!S.isAvailable()&&t("p",{className:"text-yellow-600 dark:text-yellow-400"},"Сервис AI недоступен. Укажите API_KEY в файле config.js для использования этой функции."),S.isAvailable()&&t(N,{onClick:m,disabled:c},c?"Генерация...":"Получить расширенную интерпретацию")))))},st=({setScreen:o,clientId:e,reportId:s,clients:a,testResults:i,reports:n,setReports:c})=>{const d=a.find(p=>p.id===e),r=i.filter(p=>p.clientId===e),u=s?n.find(p=>p.id===s):null,[m,g]=k(new Set((u==null?void 0:u.testResultIds)||[])),[l,x]=k((u==null?void 0:u.summary)||null),[b,v]=k(!1),[A,B]=k(n.filter(p=>p.clientId===e)),z=p=>{const f=new Set(m);f.has(p)?f.delete(p):f.add(p),g(f)},J=async()=>{if(!(!S.isAvailable()||m.size===0)){v(!0);try{const p=r.filter(R=>m.has(R.id)),f=await S.getConsolidatedInterpretation(d,p);x(f);const w={id:(u==null?void 0:u.id)||Date.now().toString(),clientId:e,date:new Date().toISOString(),testResultIds:Array.from(m),summary:f},L=[...n.filter(R=>R.id!==w.id),w];c(L),B(L.filter(R=>R.clientId===e))}catch(p){console.error(p),alert("Ошибка при генерации сводного отчета.")}finally{v(!1)}}},P=()=>{if(m.size===0)return;const p=r.filter(w=>m.has(w.id));let f=`СВОДНЫЙ ОТЧЕТ
=========================

`;f+=`Клиент: ${(d==null?void 0:d.name)||"N/A"}
`,f+=`Дата рождения: ${y((d==null?void 0:d.birthDate)||"")}

`,f+=`ОСНОВАНО НА СЛЕДУЮЩИХ ТЕСТАХ:
-------------------------
`,p.forEach(w=>{const O=I[w.testKey];f+=`- ${O.name} (от ${y(w.date)})
`,f+=`  Баллы: ${JSON.stringify(w.scores)}
`,f+=`  Интерпретация: ${Object.values(w.interpretation).join(" ")}
`}),l&&(f+=`

СВОДНЫЙ АНАЛИЗ (AI)
=========================
`,f+=l),K(`Сводный_отчет_${d==null?void 0:d.name}_${y(new Date().toISOString())}.txt`,f)},G=p=>{g(new Set(p.testResultIds)),x(p.summary)};if(!d)return t("div",null,"Клиент не найден.");const D=r.filter(p=>m.has(p.id));return t("div",null,t($,{title:"Сводный отчет",onBack:()=>o({name:"clientDetail",clientId:e})}),t("main",{className:"p-4 grid grid-cols-1 lg:grid-cols-3 gap-6"},t("div",{className:"lg:col-span-1 space-y-4"},t(h,null,t("h3",{className:"font-bold mb-2"},"1. Выберите тесты"),t("div",{className:"space-y-2 max-h-60 overflow-y-auto"},r.map(p=>t("div",{key:p.id,onClick:()=>z(p.id),className:`p-2 rounded cursor-pointer border ${m.has(p.id)?"bg-primary-100 dark:bg-primary-900 border-primary-500":"bg-gray-50 dark:bg-gray-700"}`},t("p",{className:"font-semibold"},I[p.testKey].name),t("p",{className:"text-sm"},y(p.date)))))),t(h,null,t("h3",{className:"font-bold mb-2"},"2. Сгенерируйте анализ (AI)"),t(N,{onClick:J,disabled:b||m.size===0||!S.isAvailable()},b?"Генерация...":"Создать/обновить сводный анализ"),!S.isAvailable()&&t("p",{className:"text-xs text-yellow-600 mt-2"},"Сервис AI недоступен.")),t(h,null,t("h3",{className:"font-bold mb-2"},"Сохраненные сводные отчеты"),t("div",{className:"space-y-2 max-h-60 overflow-y-auto"},A.length>0?A.map(p=>t("div",{key:p.id,onClick:()=>G(p),className:"p-2 rounded cursor-pointer bg-gray-50 dark:bg-gray-700"},`Отчет от ${y(p.date)}`)):t("p",{className:"text-sm"},"Нет отчетов.")))),t("div",{className:"lg:col-span-2 space-y-4"},t("div",{className:"flex justify-end"},t(N,{onClick:P,disabled:m.size===0,className:"flex items-center"},t(_),"Сохранить отчет (.txt)")),t(h,null,t("h3",{className:"font-bold mb-2"},"Краткая сводка по выбранным тестам"),D.length>0?t("ul",{className:"space-y-2"},D.map(p=>t("li",{key:p.id},t("strong",null,I[p.testKey].name),t("span",{className:"text-sm text-gray-500"},` (${y(p.date)})`),t("p",{className:"text-sm pl-2"},`Баллы: ${JSON.stringify(p.scores)}`),t("p",{className:"text-sm pl-2"},`Интерпретация: ${Object.values(p.interpretation).join(" ")}`)))):t("p",null,"Выберите тесты для отображения сводки.")),t(h,null,t("h3",{className:"font-bold mb-2"},"Сводный анализ (AI)"),l?t("div",{className:"whitespace-pre-wrap p-2 bg-gray-50 dark:bg-gray-700 rounded"},l):t("p",null,"Сгенерируйте анализ для просмотра.")))))},nt=({setScreen:o,setData:e})=>{const s=()=>{const n={clients:JSON.parse(localStorage.getItem("clients")||"[]"),testResults:JSON.parse(localStorage.getItem("testResults")||"[]"),reports:JSON.parse(localStorage.getItem("reports")||"[]")},c=JSON.stringify(n,null,2),d=new Blob([c],{type:"application/json"}),r=URL.createObjectURL(d),u=document.createElement("a");u.href=r,u.download=`psychosuite_backup_${new Date().toISOString().split("T")[0]}.json`,u.click(),URL.revokeObjectURL(r)},a=n=>{var d;const c=(d=n.target.files)==null?void 0:d[0];if(c){const r=new FileReader;r.onload=u=>{var m;try{const g=(m=u.target)==null?void 0:m.result;if(typeof g=="string"){const l=JSON.parse(g);if(l.clients&&l.testResults&&l.reports)e(l),alert("Данные успешно импортированы!"),o({name:"home"});else throw new Error("Invalid file structure")}}catch{alert("Ошибка при импорте файла. Убедитесь, что файл имеет правильный формат.")}},r.readAsText(c)}},i=H(null);return t("div",null,t($,{title:"Настройки",onBack:()=>o({name:"home"})}),t("main",{className:"p-4 space-y-4"},t(h,null,t("h2",{className:"text-lg font-bold mb-2"},"Экспорт данных"),t("p",{className:"text-gray-600 dark:text-gray-400 mb-4"},"Сохранить всю базу клиентов и результатов в один JSON-файл."),t(N,{onClick:s},"Экспортировать")),t(h,null,t("h2",{className:"text-lg font-bold mb-2"},"Импорт данных"),t("p",{className:"text-gray-600 dark:text-gray-400 mb-4"},"Загрузить данные из ранее экспортированного JSON-файла. Внимание: это перезапишет все текущие данные!"),t("input",{type:"file",accept:".json",onChange:a,className:"hidden",ref:i}),t(N,{onClick:()=>{var n;return(n=i.current)==null?void 0:n.click()}},"Импортировать"))))},it=()=>{const[o,e]=C({name:"home"},"screen"),[s,a]=C([],"clients"),[i,n]=C([],"testResults"),[c,d]=C([],"reports"),r=m=>{a(m.clients),n(m.testResults),d(m.reports)};return t("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900"},(()=>{switch(o.name){case"home":return t(j,{setScreen:e});case"clientList":return t(Q,{clients:s,setScreen:e});case"clientForm":return t(X,{clients:s,setClients:a,setScreen:e,clientId:o.clientId});case"clientDetail":return t(tt,{setScreen:e,clientId:o.clientId,clients:s,testResults:i,reports:c});case"test":return t(et,{setScreen:e,clientId:o.clientId,testKey:o.testKey,testResults:i,setTestResults:n});case"testResult":return t(ot,{setScreen:e,resultId:o.resultId,clients:s,testResults:i,setTestResults:n});case"report":return t(st,{setScreen:e,clientId:o.clientId,reportId:o.reportId,clients:s,testResults:i,reports:c,setReports:d});case"settings":return t(nt,{setScreen:e,setData:r});default:return t(j,{setScreen:e})}})())},at=F.createRoot(document.getElementById("root"));at.render(t(T.StrictMode,null,t(it)));const E=o=>{if(!o)return"N/A";try{return new Date(o).toLocaleDateString("ru-RU")}catch{return o}};class rt{constructor(){this.ai=null;const e=window.GEMINI_API_KEY;if(e&&e!=="ВАШ_КЛЮЧ_API_СЮДА")try{this.ai=new M({apiKey:e})}catch(s){console.error("Error initializing Gemini AI Service:",s),this.ai=null}else console.warn("Gemini API Key is not configured in config.js. AI features will be unavailable."),this.ai=null}isAvailable(){return this.ai!==null}async getTestInterpretation(e,s,a){if(!this.ai)throw new Error("AI Service is not available.");const i=`
            Ты — профессиональный клинический психолог.
            Проанализируй следующие результаты психологического теста.
            Предоставь подробную, структурированную и эмпатичную интерпретацию на основе баллов.
            Не повторяй стандартную интерпретацию дословно; расширь и дополни её.
            Объясни, что эти баллы могут означать с точки зрения эмоционального состояния, когнитивных функций и потенциальных проблемных областей.
            Предложи возможные следующие шаги или темы для обсуждения с терапевтом.
            Твой ответ должен быть на русском языке.

            Название теста: ${e}
            Баллы: ${JSON.stringify(s)}
            Стандартная интерпретация: ${a}

            Начинай свою подробную интерпретацию.
        `;return(await this.ai.models.generateContent({model:"gemini-2.5-flash",contents:i})).text}async getConsolidatedInterpretation(e,s){if(!this.ai)throw new Error("AI Service is not available.");const a=s.map(c=>`
                Тест: ${lt[c.testKey].name} (проведен ${E(c.date)})
                Баллы: ${JSON.stringify(c.scores)}
                Стандартная интерпретация: ${Object.values(c.interpretation).join(" ")}
            `).join(`
---
`),i=`
            Ты — эксперт в области клинической психологии, анализирующий несколько результатов тестов одного клиента.
            Имя клиента: ${e.name}
            Дата рождения клиента: ${E(e.birthDate)}

            Вот результаты нескольких диагностических тестов:
            ${a}

            Основываясь на этих сводных данных, предоставь целостный анализ. Твой анализ должен:
            1. Определить совпадения и расхождения в результатах разных тестов.
            2. Сформулировать всеобъемлющий психологический профиль клиента.
            3. Выделить потенциальные первичные и вторичные проблемы.
            4. Предложить предварительную диагностическую гипотезу, если это применимо.
            5. Дать рекомендации по терапевтическому вмешательству, включая возможные подходы (например, КПТ, психодинамический) и области для фокусировки.
            6. Сохранять профессиональный, эмпатичный и клинический тон.
            Твой ответ должен быть полностью на русском языке.

            Начинай свой сводный анализ.
        `;return(await this.ai.models.generateContent({model:"gemini-2.5-pro",contents:i})).text}}new rt;const lt={mmse:{name:"Mini-Mental State Examination (MMSE)",questions:[{text:"Какой сейчас год?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какое сейчас время года?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какой сейчас месяц?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какое сегодня число?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Какой сегодня день недели?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Где мы находимся? (Страна)",options:["Правильно","Неправильно"],points:[1,0]},{text:"Где мы находимся? (Область/Регион)",options:["Правильно","Неправильно"],points:[1,0]},{text:"Где мы находимся? (Город)",options:["Правильно","Неправильно"],points:[1,0]},{text:"Как называется это место (клиника/больница)?",options:["Правильно","Неправильно"],points:[1,0]},{text:"На каком этаже мы находимся?",options:["Правильно","Неправильно"],points:[1,0]},{text:"Назовите 3 слова: Яблоко, Стол, Монета. (повторил 1-е)",options:["Да","Нет"],points:[1,0]},{text:"Назовите 3 слова: Яблоко, Стол, Монета. (повторил 2-е)",options:["Да","Нет"],points:[1,0]},{text:"Назовите 3 слова: Яблоко, Стол, Монета. (повторил 3-е)",options:["Да","Нет"],points:[1,0]},{text:"Отнимите от 100 семь (93).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (86).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (79).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (72).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Еще раз отнимите семь (65).",options:["Правильно","Неправильно"],points:[1,0]},{text:"Вспомните 3 слова, которые я просил вас запомнить. (Яблоко)",options:["Да","Нет"],points:[1,0]},{text:"Вспомните 3 слова, которые я просил вас запомнить. (Стол)",options:["Да","Нет"],points:[1,0]},{text:"Вспомните 3 слова, которые я просил вас запомнить. (Монета)",options:["Да","Нет"],points:[1,0]},{text:"Покажите карандаш и часы, попросите назвать их. (Назвал карандаш)",options:["Да","Нет"],points:[1,0]},{text:"Покажите карандаш и часы, попросите назвать их. (Назвал часы)",options:["Да","Нет"],points:[1,0]},{text:"Попросите повторить фразу: 'Никаких если, и или но'.",options:["Правильно","Неправильно"],points:[1,0]},{text:"Выполните команду из 3-х частей: 'Возьмите лист бумаги правой рукой, сложите его пополам и положите на пол'. (Взял правой рукой)",options:["Да","Нет"],points:[1,0]},{text:"Выполните команду из 3-х частей. (Сложил пополам)",options:["Да","Нет"],points:[1,0]},{text:"Выполните команду из 3-х частей. (Положил на пол)",options:["Да","Нет"],points:[1,0]},{text:"Напишите 'Закройте глаза'. Попросите выполнить. (Выполнил)",options:["Да","Нет"],points:[1,0]},{text:"Попросите написать предложение. (Написал осмысленное предложение)",options:["Да","Нет"],points:[1,0]},{text:"Попросите скопировать рисунок (два пересекающихся пятиугольника). (Скопировал)",options:["Да","Нет"],points:[1,0]}],calculate:o=>({total:o.reduce((s,a)=>s+a,0)}),interpret:o=>{const e=o.total;let s="Нет когнитивных нарушений.";return e>=28&&e<=30?s="Нет когнитивных нарушений.":e>=24&&e<=27?s="Преддементные когнитивные нарушения.":e>=20&&e<=23?s="Деменция легкой степени выраженности.":e>=11&&e<=19?s="Деменция умеренной степени выраженности.":e>=0&&e<=10&&(s="Тяжелая деменция."),{cognitive_status:s}}},hads:{name:"Hospital Anxiety and Depression Scale (HADS)",questions:[{text:"Я испытываю напряжение, мне не по себе",options:["Все время","Часто","Время от времени","Совсем не испытываю"],points:[3,2,1,0]},{text:"Я испытываю страх, кажется, что что-то ужасное может вот-вот случиться",options:["Определенно это так, и страх очень велик","Да, это так, но страх не очень велик","Иногда, но это меня не беспокоит","Совсем не испытываю"],points:[3,2,1,0]},{text:"Беспокойные мысли крутятся у меня в голове",options:["Постоянно","Большую часть времени","Время от времени","Только иногда"],points:[3,2,1,0]},{text:"Я легко могу присесть и расслабиться",options:["Определенно, это так","Наверное, это так","Лишь изредка, это так","Совсем не могу"],points:[0,1,2,3]},{text:"Я испытываю внутреннее напряжение или дрожь",options:["Совсем не испытываю","Иногда","Часто","Очень часто"],points:[0,1,2,3]},{text:"Я не могу усидеть на месте, словно мне постоянно нужно двигаться",options:["Определенно, это так","Наверное, это так","Лишь в некоторой степени, это так","Вовсе нет"],points:[3,2,1,0]},{text:"У меня бывает внезапное чувство паники",options:["Очень часто","Довольно часто","Не так уж часто","Совсем не бывает"],points:[3,2,1,0]},{text:"То, что приносило мне большое удовольствие, и сейчас вызывает у меня такое же чувство",options:["Определенно, это так","Наверное, это так","Лишь в очень малой степени, это так","Практически нет"],points:[0,1,2,3]},{text:"Я способен рассмеяться и увидеть в том или ином событии смешное",options:["Определенно, это так","Наверное, это так","Лишь в очень малой степени, это так","Совсем не способен"],points:[0,1,2,3]},{text:"Я испытываю бодрость",options:["Совсем не испытываю","Очень редко","Иногда","Практически все время"],points:[3,2,1,0]},{text:"Я стал медлительным",options:["Практически все время","Часто","Иногда","Совсем нет"],points:[3,2,1,0]},{text:"Я стал следить за своей внешностью",options:["Я слежу за собой как следует","Может быть, я не так много трачу на это времени","Возможно, я стал меньше на это обращать внимания","Определенно, я перестал за собой следить"],points:[0,1,2,3]},{text:"Я считаю, что мои дела (занятия, увлечения) могут принести мне чувство удовлетворения",options:["Точно так же, как и обычно","Пожалуй, меньше, чем обычно","Значительно меньше, чем обычно","Совсем так не считаю"],points:[0,1,2,3]},{text:"Я могу получить удовольствие от хорошей книги, радио- или телепрограммы",options:["Часто","Иногда","Редко","Очень редко"],points:[0,1,2,3]}],calculate:o=>{const e=o[0]+o[2]+o[4]+o[6]+o[8]+o[10]+o[12],s=o[1]+o[3]+o[5]+o[7]+o[9]+o[11]+o[13];return{anxiety:e,depression:s}},interpret:o=>{const{anxiety:e,depression:s}=o;let a="Норма.";e>=0&&e<=7?a="Норма (отсутствие достоверно выраженных симптомов тревоги).":e>=8&&e<=10?a="Субклинически выраженная тревога.":e>=11&&(a="Клинически выраженная тревога.");let i="Норма.";return s>=0&&s<=7?i="Норма (отсутствие достоверно выраженных симптомов депрессии).":s>=8&&s<=10?i="Субклинически выраженная депрессия.":s>=11&&(i="Клинически выраженная депрессия."),{anxiety:`Anxiety: ${a}`,depression:`Depression: ${i}`}}},zung:{name:"Шкала самооценки депрессии Цунга (Zung Self-Rating Depression Scale)",questions:[{text:"Я чувствую подавленность",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Утром я чувствую себя лучше всего",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"У меня бывают периоды плача или желание плакать",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"У меня плохой ночной сон",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Аппетит у меня не хуже, чем обычно",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Мне приятно смотреть на привлекательных женщин/мужчин, разговаривать с ними",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я замечаю, что теряю вес",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Меня беспокоят запоры",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Мое сердце бьется быстрее, чем обычно",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Я устаю без всякой причины",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Я мыслю так же ясно, как всегда",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Мне легко делать то, что я умею",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Чувствую беспокойство и не могу усидеть на месте",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"У меня есть надежды на будущее",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я более раздражителен, чем обычно",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Мне легко принимать решения",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я чувствую, что полезен и нужен",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я живу достаточно полной жизнью",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]},{text:"Я чувствую, что другим людям станет лучше, если я умру",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[1,2,3,4]},{text:"Меня до сих пор радует то, что радовало всегда",options:["Никогда или редко","Иногда","Часто","Постоянно или почти постоянно"],points:[4,3,2,1]}],calculate:o=>({total:o.reduce((s,a)=>s+a,0)}),interpret:o=>{const e=o.total;let s="Состояние без депрессии.";return e<=49?s="Нормальное состояние, депрессия отсутствует.":e>=50&&e<=59?s="Легкая депрессия ситуативного или невротического генеза.":e>=60&&e<=69?s="Субдепрессивное состояние или маскированная депрессия.":e>=70&&(s="Истинное депрессивное состояние (тяжелая депрессия)."),{depression_level:s}}}};
